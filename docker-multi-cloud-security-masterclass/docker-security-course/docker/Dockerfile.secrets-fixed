FROM node:18-alpine

# Create a custom user with known UID
RUN adduser -D -u 1001 appuser

WORKDIR /app

COPY src/simple-secrets-app.js .
COPY src/package.json .

# Install dependencies
RUN npm install

# Change ownership of the app directory to our user
RUN chown -R appuser:appuser /app

# Switch to our custom user
USER appuser

EXPOSE 3000

CMD ["node", "simple-secrets-app.js"]
